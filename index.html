<!DOCTYPE html>
<html>
<head>
Â  Â  <title>Slide Generator</title>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  background-color: #1c1d20;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  }
Â  Â  Â  Â  #app-container {
Â  Â  Â  Â  Â  Â  background-color: #1c1d20;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  h1 {
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .input-group {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .input-group label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #ccc;
Â  Â  Â  Â  }
Â  Â  Â  Â  .input-group input {
Â  Â  Â  Â  Â  Â  width: 300px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border: 1px solid #333;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  Â  Â  background-color: #141416;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  #execute-btn {
Â  Â  Â  Â  Â  Â  background-color: #496396;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  #execute-btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #3963b6;
Â  Â  Â  Â  }
Â  Â  Â  Â  #status-message {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  color: #f44336;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  #teleprompter-container {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  background-color: #141416;
Â  Â  Â  Â  Â  Â  border: 1px solid #333;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  white-space: pre-wrap;
Â  Â  Â  Â  Â  Â  font-family: 'Courier New', Courier, monospace;
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  line-height: 1.5;
Â  Â  Â  Â  Â  Â  color: #f0f0f0;
            /* ðŸ‘‡ ADDED CSS FOR SCROLLING ðŸ‘‡ */
            height: 300px; /* Fixed height for the container */
            overflow-y: auto; /* Enable vertical scrolling */
Â  Â  Â  Â  }
        /* ðŸ‘‡ ADDED CSS FOR NEW BUTTONS ðŸ‘‡ */
        .teleprompter-controls {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .teleprompter-controls button {
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            border: none;
        }
        .teleprompter-controls .start-btn {
            background-color: #28a745;
            color: white;
        }
        .teleprompter-controls .start-btn:hover {
            background-color: #218838;
        }
        .teleprompter-controls .stop-btn {
            background-color: #dc3545;
            color: white;
        }
        .teleprompter-controls .stop-btn:hover {
            background-color: #c82333;
        }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="app-container">
Â  Â  Â  Â  <h1>KSAT+ NEWS BREAK</h1>
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="url1">STORY 1:</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="url1" name="url1">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="url2">STORY 2:</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="url2" name="url2">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="url3">STORY 3:</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="url3" name="url3">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button id="execute-btn">START</button>
Â  Â  Â  Â  <p id="status-message"></p>
Â  Â  Â  Â  <div id="teleprompter-container"></div>
        <div class="teleprompter-controls">
            <button class="start-btn" id="start-reading-btn">Start Reading</button>
            <button class="stop-btn" id="stop-reading-btn">Stop Reading</button>
        </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const executeButton = document.getElementById('execute-btn');
Â  Â  Â  Â  const url1Input = document.getElementById('url1');
Â  Â  Â  Â  const url2Input = document.getElementById('url2');
Â  Â  Â  Â  const url3Input = document.getElementById('url3');
Â  Â  Â  Â  const statusMessage = document.getElementById('status-message');
Â  Â  Â  Â  const teleprompterContainer = document.getElementById('teleprompter-container');

        // ðŸ‘‡ ADDED JS FOR NEW BUTTONS AND SCROLLING ðŸ‘‡
        const startReadingBtn = document.getElementById('start-reading-btn');
        const stopReadingBtn = document.getElementById('stop-reading-btn');
        
        let scrollInterval;
        let scrollSpeed = 50; // milliseconds per scroll increment. Lower is faster.

Â  Â  Â  Â  // Your Apps Script URL will go here
Â  Â  Â  Â  const scriptUrl = 'https://script.google.com/macros/s/AKfycbxv8_fUp_9HgG2RgwxjJet9sCC9EEgXHtrtgEVQ2LucUYxRs954U5P6oAfOs8Eri6WY/exec';

Â  Â  Â  Â  executeButton.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const urls = {
Â  Â  Â  Â  Â  Â  Â  Â  url1: url1Input.value,
Â  Â  Â  Â  Â  Â  Â  Â  url2: url2Input.value,
Â  Â  Â  Â  Â  Â  Â  Â  url3: url3Input.value,
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'Executing... Please wait.';
Â  Â  Â  Â  Â  Â  statusMessage.style.color = '#4CAF50';
Â  Â  Â  Â  Â  Â  teleprompterContainer.textContent = '';
            
            // Disable button to prevent multiple submissions
            executeButton.disabled = true;

Â  Â  Â  Â  Â  Â  const urlWithParams = `${scriptUrl}?url1=${encodeURIComponent(urls.url1)}&url2=${encodeURIComponent(urls.url2)}&url3=${encodeURIComponent(urls.url3)}`;

Â  Â  Â  Â  Â  Â  fetch(urlWithParams, {
Â  Â  Â  Â  Â  Â  Â  Â  method: 'GET'
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(response => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`Network response was not ok, status: ${response.status}`);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  return response.json();
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  if (data.status === 'success') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'Success! Slides have been generated and script is ready.';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.color = '#4CAF50';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (data.scriptText) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  teleprompterContainer.textContent = data.scriptText;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'Error: ' + data.message;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.color = '#f44336';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.textContent = 'An error occurred: ' + error.message;
Â  Â  Â  Â  Â  Â  Â  Â  statusMessage.style.color = '#f44336';
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Fetch Error:', error);
Â  Â  Â  Â  Â  Â  })
            .finally(() => {
                // Re-enable the button once the request is complete
                executeButton.disabled = false;
            });
Â  Â  Â  Â  });

        // ðŸ‘‡ NEW EVENT LISTENERS FOR SCROLLING ðŸ‘‡
        startReadingBtn.addEventListener('click', () => {
            stopScrolling(); // Clear any existing interval
            teleprompterContainer.scrollTop = 0; // Start from the top
            
            scrollInterval = setInterval(() => {
                // Check if we're at the bottom
                if (teleprompterContainer.scrollTop >= teleprompterContainer.scrollHeight - teleprompterContainer.clientHeight) {
                    stopScrolling();
                } else {
                    teleprompterContainer.scrollTop += 1;
                }
            }, scrollSpeed);
        });

        stopReadingBtn.addEventListener('click', () => {
            stopScrolling();
        });

        function stopScrolling() {
            clearInterval(scrollInterval);
        }
Â  Â  </script>
</body>
</html>
